jQuery(document).ready(function(a){function b(a){return!/^\s*$/.test(a)&&(a=a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@"),a=a.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]"),a=a.replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(a))}function c(c){var d='[{"text":"Document","icon":true,"li_attr":{"id":"j1_1","class":"no_dragging"},"a_attr":{"href":"#","id":"j1_1_anchor"},"state":{"loaded":true,"opened":true,"selected":true,"disabled":true},"data":{},"children":[{"id":"j1_2","text":"sample section","icon":true,"li_attr":{"id":"j1_2"},"a_attr":{"href":"#","id":"j1_2_anchor"},"state":{"loaded":true,"opened":false,"selected":false,"disabled":false},"data":{},"children":[]}]}]';if(void 0===c||0===c.length)return a.parseJSON(d);if(!b(c))return d;try{return a.parseJSON(c)}catch(b){return a.parseJSON(d)}}function d(){a(".cmb-type-tree-properties .cmb2-tree-properties-wrapper").each(function(){function b(b,c,d){var e=/___\S+/i.exec(d)[0],f=d.replace(e,"");e=e.replace("___",""),c[f]==e?a(b).show():a(b).hide()}function d(){var a=i.jstree(!0),b=JSON.stringify(a.get_json(),null," ");n.val(b).change()}function e(){var a=i.jstree(!0),b=a.get_selected()[0],c=null,e="";void 0!=b&&("j1_1"===b?a.deselect_all():(c=a.get_node(b),e=c.text)),k.html("<h3>"+e+"</h3>"),l.val(b),m.on("keyup click",function(){var a=m.jsForm("get"),b=i.jstree(!0).get_node(l.val());null!=b&&(null===b.data&&(b.data={}),null===b.data.jsform&&(b.data.jsform={}),b.data.jsform=a),d()}),null===c?(m.jsForm("reset"),m.hide()):null!=c&&null!=c.data&&null!=c.data.jsform?(m.jsForm("reset"),m.jsForm("fill",c.data.jsform),m.show()):(m.jsForm("reset"),m.show())}var h=a(this),i=h.children(".jstree.jstree-wrapper"),j=h.children(".node-properties.node-properties-wrapper"),k=j.find(".selected-node-name"),l=j.children(".selected-node-id"),m=j.children(".jsform.jsform-wrapper"),n=h.find(".tree-properties-data");m.jsForm({config:g,data:{},conditionals:{section_type___query:function(a,c){b(a,c,this.func.name)},section_type___singular:function(a,c){b(a,c,this.func.name)},query_input___json:function(a,c){b(a,c,this.func.name)},inherit_style___no:function(a,c){b(a,c,this.func.name)}}}),m.find(".e2w-data-type").on("click",function(a){var b=m.jsForm("get");m.jsForm("fill",b)}),f.core.data=c(n.val());i.on("changed.jstree rename_node.jstree update_cell.jstree-grid",function(){d(),e()}).on("init.jstree deselect_all.jstree select_node.jstree",function(){e()}).jstree(f)})}function e(b,c){return b.parents.length<2?{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.create_node(d,{},"last",function(a){setTimeout(function(){c.edit(a)},0)})}}}:{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.create_node(d,{},"last",function(a){setTimeout(function(){c.edit(a)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",shortcut:113,shortcut_label:"F2",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.edit(d)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.is_selected(d)?c.delete_node(c.get_selected()):c.delete_node(d)}}}}var f={plugins:["contextmenu","wholerow","dnd"],dnd:{is_draggable:function(a){for(var b=0,c=a.length;b<c;b++)if(this.get_node(a[b],!0).hasClass("no_dragging"))return!1;return!0}},contextmenu:{items:e},core:{check_callback:!0,contextmenu:!0}},g={trackChanges:!0};d(),window.CMB2.metabox().on("cmb2_add_row",function(a){d()}),a(".show-on-input-hover").hide(),a(".hover-show-desc").each(function(){var b=a(this).attr("class"),c=/input-for-\S+/i.exec(b)[0].replace("input-for-","desc-for-");a(this).hover(function(){a("."+c).show()},function(){a("."+c).hide()})})});